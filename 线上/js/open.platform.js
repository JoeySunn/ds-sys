var sysData={},asys=(function(){var TOTAL_PAGE=9,tab_n=1,isRightMenu=false,tabTopLeft=0,IS_SORT_TABLE=false,HOST="";function modalHtml(id){var html='<div class="modal fade" id="'+(id?id:"editbox")+'"  role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <div class="modal-header"><h4 class="modal-title text_center"></h4> </div><div class="modal-body"> <div class="pop-box"> </div> </div><div class="modal-footer text_center"><button type="button" class="btn btn-default " data-dismiss="modal" style="width: 86px;" >取消</button><button type="button" class="btn btn-primary " style="margin-left: 60px;width: 86px;" >确认</button> </div></div> </div></div>';return html}var open_sys={init:function(){if(isRightMenu){document.oncontextmenu=asys.defaultMenu;$(".tab-content").on("contextmenu","tr",function(){asys.defaultMenu();rownum=$(this).attr("data-id");asys.menuEvent(event,rownum)});$(document).on("click",".right",function(){asys.hiddenMenu()})}$(window).resize(function(){asys.tabBoxHeight();asys.showMoveBtn()});var timeId;$(".tab_top_right").click(function(){asys.tabMoveRight()});$(".tab_top_right").mousedown(function(){timeId=setInterval(function(){asys.tabMoveRight()},100)});$(".tab_top_left").click(function(){asys.tabMoveLeft()});$(".tab_top_left").mousedown(function(){timeId=setInterval(function(){asys.tabMoveLeft()},100)});$(".tab_top_left,.tab_top_right").mouseout(function(){clearTimeout(timeId)});$(".tab_top_left,.tab_top_right").mouseup(function(){clearTimeout(timeId)})},modalHtml:function(id){return modalHtml(id)},hiddenMenu:function(){var tabid=asys.getTabId();$(tabid).children(".client_menu").css("visibility","hidden")},defaultMenu:function(){window.event.returnValue=false;return false},tabBoxHeight:function(){$(".search-checkstate").each(function(){var offsetTop=$(this)[0].clientHeight;$(this).parent().find(".table_box").each(function(){$(this)[0].style.top=offsetTop+"px"})})},tabBin:function(){$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){asys.tabBoxHeight()});asys.tabBoxHeight()},getTabId:function(){return $(".tabs_top").children("li[class='active']").children("a").attr("href")},closeModal:function(){var tabid=asys.getTabId();var modalList=$(tabid).find(".modal");modalList.modal("hide")},post:function(config){config.isShwoAlert=config.isShwoAlert==undefined?true:config.isShwoAlert;$.each(config.params,function(key,val){config.params[key]=OPEN_FUN.goFun("util.trimSpace",val)});$.ajax({type:"POST",url:util.getURL(config.url),data:config.params,dataType:"json",success:function(data){if(data.status){if(config.successFun){config.successFun(data)}}else{if(data.info=="用户未登录!"){window.location.href="index.html"}else{if(config.isShwoAlert){asys.showAlert({title:"温馨提醒",msg:data.info,isCancel:false})}if(config.statusErrorFun){config.statusErrorFun(data)}}}},error:function(){if(config.isShwoAlert){asys.showAlert({title:"温馨提醒",msg:"数据请求失败！",isCancel:false})}if(config.errorFun){config.errorFun()}}})},alerts:function(config){if(!config.html){return}if(!config.alertType){config.alertType="alert-success"}var html="";if(config.isAutoHide){config.alertType+=" alert-dismissable";html='<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>'}$(".alertBox").append('<div class="alert '+config.alertType+'">'+html+config.html+"</div>");var alertDom=$(".alertBox .alert:last");if(!config.isAutoHide){var sec=3000;if(config.hideSec){sec=parseInt(config.hideSec)}setTimeout(function(){alertDom.remove()},sec)}},showAlert:function(config){if(!config.msg){return}config.isConfirm=config.isConfirm==undefined?true:config.isConfirm;config.isCancel=config.isCancel==undefined?true:config.isCancel;var confirmDom=$("#confirm");if(config.title){confirmDom.find(".modal-header").show();confirmDom.find(".modal-title").text(config.title)}else{confirmDom.find(".modal-header").hide()}confirmDom.find(".pop-box").html(config.msg);confirmDom.find(".btn-default").unbind();confirmDom.find(".btn-primary").unbind();confirmDom.find(".btn-primary").click(function(){confirmDom.modal("hide");if(config.confirmFun){config.confirmFun(confirmDom)}});confirmDom.find(".btn-default").click(function(){confirmDom.modal("hide");if(config.cancelFun){config.cancelFun(confirmDom)}});if(!config.isConfirm){confirmDom.find(".btn-primary").hide()}else{confirmDom.find(".btn-primary").show()}if(!config.isCancel){confirmDom.find(".btn-default").hide()}else{confirmDom.find(".btn-default").show()}if(config.confirmText){confirmDom.find(".btn-primary").text(config.confirmText)}else{confirmDom.find(".btn-primary").text("确认")}if(config.cancelText){confirmDom.find(".btn-default").text(config.cancelText)}else{confirmDom.find(".btn-default").text("取消")}if(!config.isConfirm&&!config.isCancel){confirmDom.find(".modal-footer").hide()}else{confirmDom.find(".modal-footer").show()}confirmDom.modal("show")},showModalHtml:function(config,isAdd){if(!config.html){return}config.isConfirm=config.isConfirm==undefined?true:config.isConfirm;config.isCancel=config.isCancel==undefined?true:config.isCancel;var tabid=asys.getTabId(),modalList=$(tabid).find(".modal");if(!isAdd){modalList.remove()}else{$(tabid).find("#addModal").remove()}$(tabid).append(modalHtml(isAdd?"addModal":""));if(isAdd){modalList=$(tabid).find("#addModal")}else{modalList=$(tabid).find(".modal")}if(config.title){modalList.find(".modal-header").show();modalList.find(".modal-title").text(config.title)}else{modalList.find(".modal-header").hide()}modalList.find(".btn-primary").click(function(){if(config.confirmFun){config.confirmFun(modalList)}else{modalList.modal("hide")}});modalList.find(".btn-default").click(function(){modalList.modal("hide");if(config.cancelFun){config.cancelFun(modalList)}});modalList.on("hide.bs.modal",config.hideFun);if(!config.isConfirm){modalList.find(".btn-primary").hide()}else{modalList.find(".btn-primary").show()}if(!config.isCancel){modalList.find(".btn-default").hide()}else{modalList.find(".btn-default").show()}if(config.confirmText){modalList.find(".btn-primary").text(config.confirmText)}else{modalList.find(".btn-primary").text("确认")}if(config.cancelText){modalList.find(".btn-default").text(config.cancelText)}else{modalList.find(".btn-default").text("取消")}if(!config.isConfirm&&!config.isCancel){modalList.find(".modal-footer").hide()}else{modalList.find(".modal-footer").show()}if(config.isFull){modalList.find(".modal-dialog").css({position:"absolute",left:"0",right:"0",top:"0",bottom:"0",width:"auto",margin:"0"});modalList.find(".modal-dialog .modal-content").css({height:"100%"});modalList.find(".modal-dialog .modal-body").css({height:"100%"})}modalList.find(".pop-box").html(config.html);modalList.modal("show");return modalList},treeHtml:function(navdata,isCheck,layer,isPower){var navstr="";$.each(navdata,function(key,value){navstr+="<li>"+(isCheck?('<input name="power" treeType="'+(isPower?"power":"tree")+'" layer="'+layer+'" value="'+value.fcode+'" type="checkbox" class="checkbox">'):"")+'<label class="icon_up"></label><a href="#" data-ischeck="'+(isCheck?"1":"0")+'" data-fcode="'+value.fcode+'"  data-funname="'+(value.funname?value.funname:"")+'" >'+value.title+"</a></li>";if(value.tree||(isCheck&&value.power)){navstr+='<ul show="true">';if(value.tree){navstr+=asys.treeHtml(value.tree,isCheck,layer+1)}else{if(isCheck&&value.power){navstr+=asys.treeHtml(value.power,isCheck,layer+1,true)}}navstr+="</ul>"}});return navstr},leftnav:function(){$(".st_tree").SimpleTree({click:function(a){var funname=$(a).data("funname"),fcode=$(a).data("fcode"),ischeck=$(a).data("ischeck"),isShowTab=false;if(ischeck==1){return}if(!funname){return}asys.setTabActve(fcode,funname,$(a).text())}})},setTabActve:function(fcode,funname,title){var isShowTab=false;$(".tabs_top").children("li").children("a").each(function(){if($(this).data("fcode")==fcode){$(this).trigger("click");isShowTab=true;return}});if(!isShowTab){tabInfo=asys.addTab(title,fcode,OPEN_FUN.getParam("OPEN."+fcode+".header"));OPEN_FUN.goFun(funname.substr(0,funname.length-2),tabInfo)}asys.onNavBin();asys.showMoveBtn()},onNavBin:function(){$(".tabs_top li").on("contextmenu",function(e){e.preventDefault();var coord=asys.getMousePos(event);if(coord.x+100>screen.availWidth){var left=coord.x-90+"px";$(".nav_menu").css("left",left)}else{$(".nav_menu").css("left",coord.x+"px")}if(coord.y+122>screen.availHeight){var top=coord.y-122+"px";$(".nav_menu").css("top",top)}else{$(".nav_menu").css("top",coord.y+"px")}$(".nav_menu").css("visibility","visible");$(".nav_menu")[0].navDom=this;return false});$(".nav_menu li").click(function(){var type=$(this).data("type"),navDom=$(".nav_menu")[0].navDom;if(type==1){$(navDom).find(".tabs_top_close").click()}else{if(type==2){$(navDom).siblings().find(".tabs_top_close").click()}else{if(type==3){$(navDom).nextAll().find(".tabs_top_close").click()}else{if(type==4){$(navDom).prevAll().find(".tabs_top_close").click()}}}}if($(navDom).parent().find("li.active").length==0){$(navDom).children("a").trigger("click")}});$(document).click(function(){$(".nav_menu").css("visibility","hidden")})},setNavWidth:function(){var width=$(".Robot_tab .tabs_top").children("li").length*100;$(".Robot_tab .tabs_top").css("width",width);asys.showMoveBtn()},tabActivePosition:function(){var boxDom=$(".tab_top_box"),navBox=$(".tabs_top"),activeLi=navBox.find("li.active"),boxWidth=boxDom.width(),navBoxWidth=navBox.width(),maxScrollLeft=navBoxWidth-boxWidth;offsetLeft=activeLi[0].offsetLeft;if(maxScrollLeft>0&&offsetLeft-boxWidth+104>0){boxDom.scrollLeft(offsetLeft-boxWidth+104);tabTopLeft=offsetLeft-boxWidth+104}else{boxDom.scrollLeft(0);tabTopLeft=0}},showMoveBtn:function(){var boxDom=$(".tab_top_box"),navBox=$(".tabs_top"),boxWidth=boxDom.width(),navBoxWidth=navBox.width(),maxScrollLeft=navBoxWidth-boxWidth;if($(".main_op").is(":hidden")){return}if(maxScrollLeft>0){$(".move_btn").show();$(".tab_top_box").css("left","42px");$(".tab_top_box").css("right","42px");asys.tabActivePosition()}else{$(".tab_top_box").css("left","0px");$(".tab_top_box").css("right","0px");$(".move_btn").hide()}},tabMoveRight:function(){var boxDom=$(".tab_top_box"),navBox=$(".tabs_top"),boxWidth=boxDom.width(),navBoxWidth=navBox.width(),maxScrollLeft=navBoxWidth-boxWidth;if(maxScrollLeft>0){if(tabTopLeft+20>maxScrollLeft){tabTopLeft=maxScrollLeft}else{tabTopLeft+=20}boxDom.scrollLeft(tabTopLeft)}else{boxDom.scrollLeft(0);tabTopLeft=0}},tabMoveLeft:function(){if(tabTopLeft-20<0){tabTopLeft=0}else{tabTopLeft-=20}$(".tab_top_box").scrollLeft(tabTopLeft)},addTab:function(tabmenu,fcode,tableHeader){var tabId="data_table"+tab_n,tabInfo={},tab_bar='<li class="active"><a href="#tab'+tab_n+'" title="'+tabmenu+'" data-fcode="'+fcode+'"  data-toggle="tab">'+tabmenu+'<span class="glyphicon glyphicon-remove-sign tabs_top_close"></span></a></li>',tab_pane='<div class="tab-pane active" id="tab'+tab_n+'"></div>';$(".Robot_tab .tab-content").children("div").removeClass("active");$(".tabs_top").children("li").removeClass("active");$(".Robot_tab .tab-content").append(tab_pane);tabInfo.tabDom=$("#tab"+tab_n);if(tableHeader){tabInfo.tableDom=asys.addTable(tabInfo.tabDom,tableHeader,tableHeader.isTwoTable,tabId)}tab_n++;$(".Robot_tab .tabs_top").append(tab_bar);asys.setNavWidth();return tabInfo},addTable:function(jqDom,tableTile,isTwoTable,tabId){if(isTwoTable){var classManagestr='<div class="classManage"><div class="classManage_left"><div class="classManage_head"></div><div class="classManage_body">';classManagestr+=getTableHtml(tableTile[0],tabId+"_1");classManagestr+="</div></div>";classManagestr+='<div class="classManage_right">';classManagestr+='<div class="classManage_head">';classManagestr+="</div>";classManagestr+='<div class="classManage_body">';classManagestr+=getTableHtml(tableTile[1],tabId+"_2");classManagestr+="</div></div>";classManagestr+="</div>";jqDom.append(classManagestr);return[$("#"+(tabId+"_1")),$("#"+tabId+"_2")]}else{var table='<div class="table_box" hidden>'+getTableHtml(tableTile,tabId)+"</div>";jqDom.append(table);return $("#"+tabId)}function getTableHtml(tableTile,tabId){var html='<div class="fixed_table_container"><div class="scroll_box"><div class="fixed-table-header"></div><div class="fixed-table-body"><table id='+(tabId?tabId:"info")+' class="table table-bordered table-condensed text_center"><thead><tr>',per=100;if(tableTile.isCheck){per=98;html+='<th style="width:2%;"><div class="th-inner" style="width:2%;"><input name="btSelectAll" type="checkbox" class="checkbox"></div></th>'}var pro=per/tableTile.title.length;$.each(tableTile.title,function(key,value){html+='<th style="width:'+pro+'%;"><div class="th-inner ellipsis" style="width:'+pro+'%;">'+value+"</div></th>"});html+="</tr></thead><tbody></tbody></table></div><div></div>";return html}},addSearch:function(obj,html,getDataFun){obj.prepend(html);obj.find(".search_box .btn-default").click(function(){var t=$(this).closest(".form-inline")[0].reset();getDataFun(1)});obj.find(".search_box .btn-primary").click(function(){var data={};var t=$(this).closest(".form-inline").serializeArray();$.each(t,function(){data[this.name]=this.value});getDataFun(1,data)})},tableSort:function(tableDom,dataParamName){if(!IS_SORT_TABLE){return}var th=tableDom.find("th");$.each(dataParamName,function(i){th.eq(i).find("div").attr("data-field",this).addClass("sort")});th.find(".sort").unbind();th.find(".sort").click(function(){var self=this,getData=tableDom[0].getDataFun,param={},field=$(self).data("field"),sort_type=self.sort_type;th.find(".order").remove();$.each(th,function(){var btn=$(this).find("div")[0];if(self!=btn){btn.sort_type="DESC"}});if(sort_type=="DESC"){self.sort_type="ASC";$(self).append('<span class="order"><span class="caret"></span></span>');param.sort=JSON.stringify([{sort_name:field},{sort_type:"ASC"}]);getData("",param)}else{self.sort_type="DESC";$(self).append('<span class="order dropup"><span class="caret"></span></span>');param.sort=JSON.stringify([{sort_name:field},{sort_type:"DESC"}]);getData("",param)}})},tableCont:function(config){config.tableDom.parent().find(".noData").remove();config.tableDom.find("tbody").html("");asys.tableSort(config.tableDom,config.paramConfig.dataParamName);$.each(config.data,function(k,v){var str="<tr>";if(config.checkVlaue){str+='<td tdlayer=1><input name="btSelect" type="checkbox" value="'+eval("v."+config.checkVlaue)+'"  class="checkbox"></div></td>'}var trInfo=tdHtml(v,config.paramConfig.dataParamName,1);str+=trInfo.str;if(config.paramConfig.power&&config.setOpname){str+=config.setOpname(config.paramConfig.power,v,false)}if(config.paramConfig.powers&&config.setOpname){str+=config.setOpname(config.paramConfig.powers,v,true)}str+="</tr>";config.tableDom.find("tbody").append(str);var trDom=config.tableDom.find("tbody tr:last")[0];trDom.trData=v;trDom.isFirst=true;if(trInfo.layer>1){rowSpan=tdMerge(v,v,2,trInfo.rowspans,trDom);$(trDom).find("td[tdlayer=1]").attr("rowSpan",rowSpan?rowSpan:1)}});function tdMerge(v,lists,tdLayer,rowspans,trDom){var data=util.objDataValue(lists,rowspans[1]),rowSpan=1;if(data&&data.length==1){if(rowspans[3].length>0){rowSpan=tdMerge(v,data[0],tdLayer+1,rowspans[3],trDom);$(trDom).find("td[tdlayer="+(tdLayer)+"]").attr("rowSpan",rowSpan?rowSpan:1)}return rowSpan}if(!data){return 1}var rowSpanCount=0;$.each(data,function(k,val){if(k==0){if(rowspans[3].length>0){rowSpan=tdMerge(v,val,tdLayer+1,rowspans[3],trDom);$(trDom).find("td[tdlayer="+(tdLayer)+"]").attr("rowSpan",rowSpan?rowSpan:1)}rowSpanCount+=rowSpan;return}var str="<tr>";var trInfo=tdHtml(val,rowspans[2],tdLayer);str+=trInfo.str;if(config.paramConfig.power){str+=config.setOpname(config.paramConfig.power,v,false,val)}str+="</tr>";config.tableDom.find("tbody").append(str);var trLastDom=config.tableDom.find("tbody tr:last")[0];trLastDom.trData=v;trLastDom.isFirst=false;trLastDom.layerData=val;if(rowspans[3].length>0){rowSpan=tdMerge(v,val,tdLayer+1,rowspans[3],trLastDom)}$(trLastDom).find("td[tdlayer="+(tdLayer)+"]").attr("rowSpan",rowSpan?rowSpan:1);rowSpanCount+=rowSpan});return rowSpanCount}function tdHtml(v,dataParamName,layer){var str="",rowspans,rowspan=[];$.each(dataParamName,function(key,value){if(value instanceof Object&&!(value instanceof Array)){$.each(value,function(keys,values){var rowData=util.objDataValue(v,keys);rowspan.push(rowData?rowData.length:1);rowspan.push(keys);rowspan.push(values);var data=util.objDataValue(v,keys+"[0]");var tr=tdHtml(data,values,layer+1);rowspan.push(tr.rowspans);layer=tr.layer;str+=tr.str})}else{var data;if(value instanceof Array){data={};$.each(value,function(){data[this]=util.objDataValue(v,this)})}else{data=util.objDataValue(v,value)}str+="<td name="+value+' tdLayer="'+layer+'">'+(data?config.paramConfig.getValueText(value,data,config.paramConfig.name):"-")+"</td>"}});return{str:str,layer:layer,rowspans:rowspan}}function getMaxRowSpan(data,arr_layer){var max=0;if(arr_layer>1){max+=getMaxRowSpan(data[3],arr_layer-1)}else{max=data[0]==1?0:data[0]}return max}asys.tabBin();config.tableDom.find(".operation a").click(config.optionClick);if(config.trDblClick){config.tableDom.find("tbody tr").dblclick(config.trDblClick)}if(config.checkVlaue){config.tableDom.find("input[name=btSelectAll]").click(function(){if(this.checked){config.tableDom.find("[name = btSelect]:checkbox:not([disabled='disabled'])").prop("checked",true)}else{config.tableDom.find("[name = btSelect]:checkbox").prop("checked",false)}})}config.tableDom.closest(".table_box").show();config.tableDom.colResizable({liveDrag:true,gripInnerHtml:"<div class='grip'></div>",draggingClass:"dragging",resizeMode:"overflow"});if(!config.data||config.data.length==0){config.tableDom.parent().append("<div class='noData'>无符合查询条件的结果</div>")}},pagination:function(config){if(!config.dom){return}var pagestr='<div aria-label="Page navigation" class="pages"> <ul class="pagination">';if(config.count<config.limit){pagestr+='<li><a aria-label="refresh" style="margin-left:10px"><span class="glyphicon glyphicon-refresh"></span></a></li>'}else{var limit=config.limit?config.limit:10,page=config.page?config.page:1,countPage=Math.ceil(config.count/config.limit),pageNum=TOTAL_PAGE,startPage=1;page=parseInt(page);if(countPage>=pageNum){if(page>Math.ceil(pageNum/2)&&countPage>(page+(Math.ceil(pageNum/2))-1)){startPage=(page-Math.ceil(pageNum/2))+1}else{if(page>Math.ceil(pageNum/2)){startPage=countPage-pageNum+1}}}else{pageNum=countPage}pagestr+="<li "+(page==1?'class="disabled"':"")+'><a aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>';for(var i=0;i<pageNum;i++){pagestr+="<li "+(startPage==page?'class="active"':"")+'><a aria-label="'+startPage+'" >'+startPage+"</a></li>";startPage++}pagestr+="<li "+(page==countPage?'class="disabled"':"")+'><a aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li><li><a aria-label="refresh" style="margin-left:10px"><span class="glyphicon glyphicon-refresh"></span></a></li>';if(countPage>TOTAL_PAGE){pagestr+='<li><span  style="margin-left:10px">共'+countPage+'页</span></li><li><span class="input_box"><input type="text" class="form-control pageNum" placeholder="页数"></span></li><li><a aria-label="jump_btn"><span>跳转</span></a></li>'}}pagestr+="</ul></div>";var pageBox=config.dom.find(".pages");if(pageBox.length!=0){pageBox.remove()}config.dom.append(pagestr);config.dom.find(".pages .pageNum").on("input",function(){var value=OPEN_FUN.goFun("util.trimSpace",this.value);if(isNaN(value)){$(this).val("");return}value=parseInt(value);if(value<0){$(this).val("");return}$(this).val(value)});asys.binPageEvent(config.dom.find(".pages"),config.getDataFun,page,countPage)},binPageEvent:function(obj,getDataFun,page,countPage){obj.on("click","a",function(){if($(this).attr("aria-label")=="refresh"){getDataFun(1)}else{if($(this).attr("aria-label")=="Previous"&&!$(this).parent().hasClass("disabled")){getDataFun(--page)}else{if($(this).attr("aria-label")=="Next"&&!$(this).parent().hasClass("disabled")){getDataFun(++page)}else{if($(this).attr("aria-label")=="jump_btn"){var value=OPEN_FUN.goFun("util.trimSpace",obj.find(".pageNum").val());if(value==""){asys.showAlert({title:"温馨提醒",msg:"请输入需要跳转到的页码",isCancel:false});return}if(isNaN(value)){asys.showAlert({title:"温馨提醒",msg:"请输入数字",isCancel:false});return}value=parseInt(value);if(value<=0){asys.showAlert({title:"温馨提醒",msg:"请输入正数",isCancel:false});return}if(countPage<value){asys.showAlert({title:"温馨提醒",msg:"超过最大页码数了！",isCancel:false});return}getDataFun(value)}else{if(!isNaN($(this).attr("aria-label"))){getDataFun(parseInt($(this).attr("aria-label")))}}}}}})},datePicker:function(obj,config){var pickerConfig={language:"zh-CN",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,minView:2,forceParse:0};pickerConfig=$.extend(pickerConfig,config);$(obj).datetimepicker(pickerConfig)},getMousePos:function(event){var e=event||window.event,scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,x=e.pageX||e.clientX+scrollX,y=e.pageY||e.clientY+scrollY;return{x:x,y:y}},menuEvent:function(event){var coord=asys.getMousePos(event),tabid=asys.getTabId();if(coord.x+100>screen.availWidth){var left=coord.x-90+"px";$(tabid).children(".client_menu").css("left",left)}else{$(tabid).children(".client_menu").css("left",coord.x+"px")}if(coord.y+122>screen.availHeight){var top=coord.y-122+"px";$(tabid).children(".client_menu").css("top",top)}else{$(tabid).children(".client_menu").css("top",coord.y+"px")}$(tabid).children(".client_menu").css("visibility","visible");return false},select2Init:function(jqDom,url,successFun){jqDom.select2({ajax:{type:"POST",url:util.getURL("Product/lists"),dataType:"json",delay:250,data:function(params){return{search_val:params.term,limit:1000}},processResults:function(data,params){if(data.status){return successFun(data)}},cache:true},placeholder:"请选择",language:"zh-CN",tags:false,allowClear:true,escapeMarkup:function(markup){return markup},minimumInputLength:1,formatResult:function formatRepo(repo){return repo.text},formatSelection:function formatRepoSelection(repo){return repo.text}})}};return open_sys}());$(function(){asys.post({url:"Permissions/head_menu",params:{},successFun:function(d){if(d.status){var b=d.info;var c="";c+="<ul>";$.each(b,function(f,e){c+='<li class="" data-funname="'+e.fcode+'"><a>'+e.title+"</a></li>"});c+="</ul>";$("#Platform_nav").html(c)}}});asys.post({url:"SystemAccount/info",params:{},successFun:function(b){sysData.acc_info=b.info;$("#admin_name").text(b.info.account)}});$("#outSys").click(function(){var b={url:"SystemAccount/logout_do",params:{},successFun:function(c){}};asys.post(b);setTimeout(function(){window.location.href="index.html"},100)});var a=false;$("#admin_btn").click(function(){$(".admin_op_box").show();a=false});$("#pwd_edit").click(function(){OPEN_FUN.goFun("resetPwd")});$(document).on("click",function(){if(a){$(".admin_op_box").hide()}else{a=true}});$(document).on("click","#Platform_nav li",function(){$(".main_op").show();$(".welcome").hide();var b=$(this).data("funname");$(this).addClass("active").siblings().removeClass("active");OPEN_FUN.goFun("getChsild",b)});$(".tabs_top").on("click",".tabs_top_close",function(){var b=$(this).parent().attr("href");var c=$(this).parent().parent("li").nextAll().length;$(b).remove();if($(this).parent().parent("li").hasClass("active")){if(c==0){$(this).parent().parent("li").prev("li").children("a").trigger("click");$($(this).parent().parent("li").prev("li").children("a").attr("href")).addClass("active")}else{$(this).parent().parent("li").next("li").children("a").trigger("click");$($(this).parent().parent("li").next("li").children("a").attr("href")).addClass("active")}}$(this).parent().parent("li").remove();asys.setNavWidth();if($(".tabs_top").children().length==0){$(".welcome").show();$(".main_op").hide();$("#Platform_nav li").removeClass("active")}});asys.init()});